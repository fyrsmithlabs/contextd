# config.example.yaml
# Contextd Configuration
# Copy to ~/.config/contextd/config.yaml and modify as needed.
# File MUST have 0600 permissions: chmod 600 ~/.config/contextd/config.yaml
#
# Environment variables override file values.
# Mapping: SECTION_FIELD_NAME -> section.field_name
# Example: SERVER_HTTP_PORT -> server.http_port

# Server Configuration
server:
  http_port: 9090              # HTTP server port (default: 9090)
  shutdown_timeout: 10s        # Graceful shutdown timeout (default: 10s)

# Observability Configuration (OpenTelemetry)
observability:
  enable_telemetry: false      # Enable OTEL tracing (default: true)
  service_name: contextd       # Service name for traces (default: contextd)

# Pre-Fetch Configuration
# Proactively loads context based on git state
prefetch:
  enabled: true                # Enable pre-fetch engine (default: true)
  cache_ttl: 5m                # Cache TTL (default: 5m)
  cache_max_entries: 100       # Maximum cache entries (default: 100)

  # Individual rule configuration (optional, defaults shown)
  # rules:
  #   branch_diff:
  #     enabled: true
  #     max_files: 10
  #     max_size_kb: 50
  #     timeout_ms: 1000
  #   recent_commit:
  #     enabled: true
  #     max_size_kb: 20
  #     timeout_ms: 500
  #   common_files:
  #     enabled: true
  #     max_files: 3
  #     timeout_ms: 500

# Checkpoint Configuration
checkpoint:
  max_content_size_kb: 1024    # Maximum content size in KB (default: 1024 = 1MB)

# Example environment variable overrides:
# export SERVER_HTTP_PORT=8080
# export SERVER_SHUTDOWN_TIMEOUT=30s
# export OBSERVABILITY_ENABLE_TELEMETRY=true
# export OBSERVABILITY_SERVICE_NAME=my-contextd
# export PREFETCH_ENABLED=false
# export PREFETCH_CACHE_TTL=10m
# export CHECKPOINT_MAX_CONTENT_SIZE_KB=2048
